(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[98],{6249:function(){},5810:function(e,t,n){Promise.resolve().then(n.bind(n,5508))},5508:function(e,t,n){"use strict";n.d(t,{default:function(){return u}});var s=n(7437),r=n(2265),o=n(9376),i=n(9501),a=n(7996),l=n(7492),c=n(4362);function u(){let[e,t]=(0,r.useState)(!1),[n,u]=(0,r.useState)(!1),[d,m]=(0,r.useState)(null),p=(0,o.useRouter)(),{checkAuth:g}=(0,c.a)(),{register:f,handleSubmit:y,formState:{errors:S}}=(0,i.cI)(),h=async e=>{t(!0),m(null);try{await l.Y.signIn(e),await g(),p.push("/")}catch(e){m(e)}finally{t(!1)}};return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to AmIAnAI"}),(0,s.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Join anonymous conversations with AI"})]}),(0,s.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:y(h),children:[d&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,s.jsx)("p",{className:"text-sm text-red-600",children:d.message})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),(0,s.jsx)("input",{...f("email",{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}}),type:"email",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",placeholder:"your@email.com"}),S.email&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:S.email.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,s.jsxs)("div",{className:"mt-1 relative",children:[(0,s.jsx)("input",{...f("password",{required:"Password is required"}),type:n?"text":"password",className:"block w-full px-3 py-2 pr-10 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",placeholder:"Your password"}),(0,s.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>u(!n),children:n?(0,s.jsx)(a.rzC,{className:"h-5 w-5 text-gray-400"}):(0,s.jsx)(a.rDJ,{className:"h-5 w-5 text-gray-400"})})]}),S.password&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:S.password.message})]})]}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"submit",disabled:e,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:e?"Signing in...":"Sign in"})}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("button",{type:"button",onClick:()=>p.push("/auth/signup"),className:"text-primary-600 hover:text-primary-500 text-sm",children:"Don't have an account? Sign up"})})]})]})})}},4362:function(e,t,n){"use strict";n.d(t,{AuthProvider:function(){return c},a:function(){return u}});var s=n(7437),r=n(2265),o=n(9376),i=n(7492),a=n(571);let l=(0,r.createContext)(void 0),c=e=>{let{children:t}=e,[n,c]=(0,r.useState)(!1),[u,d]=(0,r.useState)(!0),[m,p]=(0,r.useState)(null),g=(0,o.useRouter)(),f=async()=>{try{let e=await i.Y.getCurrentUser();e?(c(!0),p(e)):(c(!1),p(null))}catch(e){c(!1),p(null)}finally{d(!1)}};return(0,r.useEffect)(()=>{f()},[]),(0,s.jsx)(l.Provider,{value:{isAuthenticated:n,isLoading:u,user:m,checkAuth:f,signOut:()=>{i.Y.signOut(),c(!1),p(null),a.F.getState().reset(),window.localStorage.clear(),window.sessionStorage.clear(),g.push("/auth/signin")}},children:t})},u=()=>{let e=(0,r.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},7492:function(e,t,n){"use strict";n.d(t,{Y:function(){return o}});var s=n(3250);let r=new s.AM({UserPoolId:"us-east-1_ipC2hJAsT",ClientId:"6mvdodv3vud2pi5sv0oig920ne"}),o={signUp:async e=>{let{email:t,password:n}=e;return new Promise((e,o)=>{let i=[new s.KC({Name:"email",Value:t})];r.signUp(t,n,i,[],t=>{if(t){o({code:t.code||"UnknownError",message:t.message||"An unknown error occurred"});return}e()})})},confirmSignUp:async(e,t)=>new Promise((n,o)=>{new s.ws({Username:e,Pool:r}).confirmRegistration(t,!0,e=>{if(e){o({code:e.code||"UnknownError",message:e.message||"An unknown error occurred"});return}n()})}),signIn:async e=>{let{email:t,password:n}=e;return new Promise((e,o)=>{let i=new s.sD({Username:t,Password:n});new s.ws({Username:t,Pool:r}).authenticateUser(i,{onSuccess:()=>{e()},onFailure:e=>{o({code:e.code||"UnknownError",message:e.message||"An unknown error occurred"})}})})},getCurrentUser:async()=>new Promise(e=>{let t=r.getCurrentUser();if(!t){e(null);return}t.getSession((n,s)=>{if(n||!s||!s.isValid()){e(null);return}t.getUserAttributes((t,n)=>{var s,r;if(t||!n){e(null);return}let o=null===(s=n.find(e=>"email"===e.getName()))||void 0===s?void 0:s.getValue(),i=null===(r=n.find(e=>"sub"===e.getName()))||void 0===r?void 0:r.getValue();if(!o||!i){e(null);return}e({email:o,sub:i,role:"user"})})})}),signOut:()=>{let e=r.getCurrentUser();e&&e.signOut()},getIdToken:async()=>new Promise(e=>{let t=r.getCurrentUser();if(!t){e(null);return}t.getSession((t,n)=>{if(t||!n||!n.isValid()){e(null);return}e(n.getIdToken().getJwtToken())})})}},571:function(e,t,n){"use strict";n.d(t,{F:function(){return i}});var s=n(3011),r=n(6885);let o="wss://i5csamj3a8.execute-api.us-east-1.amazonaws.com/prod",i=(0,s.U)()((0,r.mW)((e,t)=>({connectionStatus:"disconnected",ws:null,sessionId:null,myIdentity:null,participants:[],messages:[],sessionStartTime:null,timeRemaining:null,isSessionActive:!1,isRevealed:!1,identityReveal:null,connect:()=>{var n;if((null===(n=t().ws)||void 0===n?void 0:n.readyState)!==WebSocket.OPEN){e({connectionStatus:"connecting"}),console.log("Attempting WebSocket connection to:",o);try{let n=new WebSocket(o);n.onopen=()=>{console.log("✅ WebSocket connected successfully"),e({connectionStatus:"connected",ws:n}),console.log("Sending join message..."),n.send(JSON.stringify({action:"join"}))},n.onmessage=e=>{try{let n=JSON.parse(e.data);switch(console.log("\uD83D\uDCE8 Received:",n),n.action){case"connected":t().handleConnect(n);break;case"message":t().handleMessage(n);break;case"participants":t().handleParticipantUpdate(n.participants);break;case"session_end":t().handleSessionEnd(n.reveal);break;default:console.log("Unknown message:",n)}}catch(e){console.error("Failed to parse message:",e)}},n.onerror=t=>{console.error("❌ WebSocket error:",t),console.error("WebSocket readyState:",n.readyState),e({connectionStatus:"error"})},n.onclose=n=>{console.log("\uD83D\uDD0C WebSocket disconnected. Code:",n.code,"Reason:",n.reason),e({connectionStatus:"disconnected",ws:null}),1e3!==n.code&&(console.log("\uD83D\uDD04 Retrying connection in 3 seconds..."),setTimeout(()=>{let e=t();"disconnected"===e.connectionStatus&&e.connect()},3e3))},setTimeout(()=>{n.readyState===WebSocket.CONNECTING&&(console.error("⏰ WebSocket connection timeout"),n.close(),e({connectionStatus:"error"}))},1e4)}catch(t){console.error("\uD83D\uDCA5 Failed to create WebSocket:",t),e({connectionStatus:"error"})}}},disconnect:()=>{let{ws:n}=t();n&&n.close(),e({connectionStatus:"disconnected",ws:null})},sendMessage:e=>{let{ws:n}=t();(null==n?void 0:n.readyState)===WebSocket.OPEN&&n.send(JSON.stringify({action:"message",content:e.trim()}))},handleConnect:t=>{e({myIdentity:t.identity,sessionId:t.sessionId,sessionStartTime:Date.now(),isSessionActive:!0,timeRemaining:600})},handleMessage:t=>{e(e=>({messages:[...e.messages,t]}))},handleParticipantUpdate:t=>{e({participants:t})},handleSessionEnd:t=>{e({isSessionActive:!1,isRevealed:!0,identityReveal:t,timeRemaining:0})},updateTimer:t=>{e({timeRemaining:t}),t<=0&&e({isSessionActive:!1})},reset:()=>{let{ws:n}=t();n&&n.close(),e({connectionStatus:"disconnected",ws:null,sessionId:null,myIdentity:null,participants:[],messages:[],sessionStartTime:null,timeRemaining:null,isSessionActive:!1,isRevealed:!1,identityReveal:null})}}),{name:"session-store"}))},6885:function(e,t,n){"use strict";n.d(t,{mW:function(){return l}});let s=new Map,r=e=>{let t=s.get(e);return t?Object.fromEntries(Object.entries(t.stores).map(([e,t])=>[e,t.getState()])):{}},o=(e,t,n)=>{if(void 0===e)return{type:"untracked",connection:t.connect(n)};let r=s.get(n.name);if(r)return{type:"tracked",store:e,...r};let o={connection:t.connect(n),stores:{}};return s.set(n.name,o),{type:"tracked",store:e,...o}},i=(e,t)=>{if(void 0===t)return;let n=s.get(e);n&&(delete n.stores[t],0===Object.keys(n.stores).length&&s.delete(e))},a=e=>{var t,n;if(!e)return;let s=e.split("\n"),r=s.findIndex(e=>e.includes("api.setState"));if(r<0)return;let o=(null==(t=s[r+1])?void 0:t.trim())||"";return null==(n=/.+ (.+) .+/.exec(o))?void 0:n[1]},l=(e,t={})=>(n,s,l)=>{let u;let{enabled:d,anonymousActionType:m,store:p,...g}=t;try{u=(null==d||d)&&window.__REDUX_DEVTOOLS_EXTENSION__}catch(e){}if(!u)return e(n,s,l);let{connection:f,...y}=o(p,u,g),S=!0;l.setState=(e,t,o)=>{let i=n(e,t);if(!S)return i;let c=a(Error().stack),u=void 0===o?{type:m||c||"anonymous"}:"string"==typeof o?{type:o}:o;return void 0===p?null==f||f.send(u,s()):null==f||f.send({...u,type:`${p}/${u.type}`},{...r(g.name),[p]:l.getState()}),i},l.devtools={cleanup:()=>{f&&"function"==typeof f.unsubscribe&&f.unsubscribe(),i(g.name,p)}};let h=(...e)=>{let t=S;S=!1,n(...e),S=t},v=e(l.setState,s,l);if("untracked"===y.type?null==f||f.init(v):(y.stores[y.store]=l,null==f||f.init(Object.fromEntries(Object.entries(y.stores).map(([e,t])=>[e,e===y.store?v:t.getState()])))),l.dispatchFromDevtools&&"function"==typeof l.dispatch){let e=!1,t=l.dispatch;l.dispatch=(...n)=>{"__setState"!==n[0].type||e||(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),e=!0),t(...n)}}return f.subscribe(e=>{var t;switch(e.type){case"ACTION":if("string"!=typeof e.payload){console.error("[zustand devtools middleware] Unsupported action format");return}return c(e.payload,e=>{if("__setState"===e.type){if(void 0===p){h(e.state);return}1!==Object.keys(e.state).length&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);let t=e.state[p];if(null==t)return;JSON.stringify(l.getState())!==JSON.stringify(t)&&h(t);return}l.dispatchFromDevtools&&"function"==typeof l.dispatch&&l.dispatch(e)});case"DISPATCH":switch(e.payload.type){case"RESET":if(h(v),void 0===p)return null==f?void 0:f.init(l.getState());return null==f?void 0:f.init(r(g.name));case"COMMIT":if(void 0===p){null==f||f.init(l.getState());break}return null==f?void 0:f.init(r(g.name));case"ROLLBACK":return c(e.state,e=>{if(void 0===p){h(e),null==f||f.init(l.getState());return}h(e[p]),null==f||f.init(r(g.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return c(e.state,e=>{if(void 0===p){h(e);return}JSON.stringify(l.getState())!==JSON.stringify(e[p])&&h(e[p])});case"IMPORT_STATE":{let{nextLiftedState:n}=e.payload,s=null==(t=n.computedStates.slice(-1)[0])?void 0:t.state;if(!s)return;void 0===p?h(s):h(s[p]),null==f||f.send(null,n);break}case"PAUSE_RECORDING":return S=!S}return}}),v},c=(e,t)=>{let n;try{n=JSON.parse(e)}catch(e){console.error("[zustand devtools middleware] Could not parse the received json",e)}void 0!==n&&t(n)}},3011:function(e,t,n){"use strict";n.d(t,{U:function(){return l}});var s=n(2265);let r=e=>{let t;let n=new Set,s=(e,s)=>{let r="function"==typeof e?e(t):e;if(!Object.is(r,t)){let e=t;t=(null!=s?s:"object"!=typeof r||null===r)?r:Object.assign({},t,r),n.forEach(n=>n(t,e))}},r=()=>t,o={setState:s,getState:r,getInitialState:()=>i,subscribe:e=>(n.add(e),()=>n.delete(e))},i=t=e(s,r,o);return o},o=e=>e?r(e):r,i=e=>e,a=e=>{let t=o(e),n=e=>(function(e,t=i){let n=s.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return s.useDebugValue(n),n})(t,e);return Object.assign(n,t),n},l=e=>e?a(e):a}},function(e){e.O(0,[956,181,237,971,117,744],function(){return e(e.s=5810)}),_N_E=e.O()}]);