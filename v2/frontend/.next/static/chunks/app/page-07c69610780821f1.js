(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6249:function(){},255:function(e,t,n){Promise.resolve().then(n.bind(n,3002)),Promise.resolve().then(n.bind(n,7551))},7551:function(e,t,n){"use strict";n.d(t,{default:function(){return m}});var s=n(7437),r=n(2265),a=n(7996),i=n(571),l=n(4362);function o(e){let{message:t,isMyMessage:n}=e;return(0,s.jsx)("div",{className:"flex mb-4 ".concat(n?"justify-end":"justify-start"),children:(0,s.jsxs)("div",{className:"max-w-xs lg:max-w-md ".concat(n?"order-1":"order-2"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat({A:"bg-blue-100 text-blue-800",B:"bg-green-100 text-green-800",C:"bg-purple-100 text-purple-800",D:"bg-orange-100 text-orange-800"}[t.sender]),children:t.sender}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:new Date(t.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,s.jsx)("div",{className:"\n          px-4 py-2 rounded-lg\n          ".concat(n?"bg-primary-600 text-white":"bg-white border border-gray-200","\n        "),children:(0,s.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:t.content})})]})})}function c(){let{messages:e,myIdentity:t}=(0,i.F)(),n=(0,r.useRef)(null);return((0,r.useEffect)(()=>{var e;null===(e=n.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[e]),0===e.length)?(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,s.jsxs)("div",{className:"text-center p-8",children:[(0,s.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDCAC"}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Waiting for conversation to begin"}),(0,s.jsx)("p",{className:"text-gray-600 max-w-md",children:"Once all participants join, the 10-minute anonymous conversation will start. Two humans and two AI participants will engage in discussion."})]})}):(0,s.jsx)("div",{className:"h-full overflow-y-auto",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto p-4",children:[e.map((e,n)=>(0,s.jsx)(o,{message:e,isMyMessage:e.sender===t},"".concat(e.timestamp,"-").concat(n))),(0,s.jsx)("div",{ref:n})]})})}function d(){let{participants:e,myIdentity:t}=(0,i.F)(),n=e=>({A:"bg-blue-500",B:"bg-green-500",C:"bg-purple-500",D:"bg-orange-500"})[e],r=["A","B","C","D"].map(n=>{var s;let r=e.find(e=>e.identity===n);return{identity:n,isConnected:null!==(s=null==r?void 0:r.isConnected)&&void 0!==s&&s,isMe:n===t}});return(0,s.jsx)("div",{className:"bg-white border-b border-gray-200 px-4 py-3",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-sm font-medium text-gray-700",children:"Participants"}),(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:[e.filter(e=>e.isConnected).length,"/4 connected"]})]}),(0,s.jsx)("div",{className:"flex gap-3 mt-2",children:r.map(e=>{let{identity:t,isConnected:r,isMe:a}=e;return(0,s.jsxs)("div",{className:"\n                flex items-center gap-2 px-3 py-2 rounded-lg border\n                ".concat(r?"border-gray-200 bg-gray-50":"border-dashed border-gray-300 bg-gray-25","\n                ").concat(a?"ring-2 ring-primary-200":"","\n              "),children:[(0,s.jsx)("div",{className:"\n                w-3 h-3 rounded-full\n                ".concat(r?n(t):"bg-gray-300","\n              ")}),(0,s.jsx)("span",{className:"\n                text-sm font-medium\n                ".concat(r?"text-gray-900":"text-gray-400","\n              "),children:t}),a&&(0,s.jsx)("span",{className:"text-xs text-primary-600 font-medium",children:"(You)"}),!r&&(0,s.jsx)("span",{className:"text-xs text-gray-400",children:"Waiting..."})]},t)})}),e.filter(e=>e.isConnected).length<4&&(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Session will begin when all participants have joined"})]})})}function u(){let{timeRemaining:e,isSessionActive:t,updateTimer:n}=(0,i.F)();return((0,r.useEffect)(()=>{if(!t||null===e)return;let s=setInterval(()=>{n(Math.max(0,e-1))},1e3);return()=>clearInterval(s)},[e,t,n]),t&&null!==e)?(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:"text-xs text-gray-500",children:"Time remaining"}),(0,s.jsx)("div",{className:"text-sm font-mono font-bold ".concat(e>300?"text-green-600":e>120?"text-yellow-600":"text-red-600"),children:"".concat(Math.floor(e/60),":").concat((e%60).toString().padStart(2,"0"))})]}),(0,s.jsx)("div",{className:"w-20 h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full transition-all duration-1000 ".concat(e>300?"bg-green-500":e>120?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(Math.max(0,e/600*100),"%")}})})]}):null}function m(){let[e,t]=(0,r.useState)(""),n=(0,r.useRef)(null),{connectionStatus:o,myIdentity:m,isSessionActive:x,isRevealed:g,connect:h,disconnect:f,sendMessage:p,reset:b}=(0,i.F)(),{user:y,signOut:v}=(0,l.a)();(0,r.useEffect)(()=>{"disconnected"===o&&h()},[h,o]),(0,r.useEffect)(()=>{"connected"===o&&n.current&&n.current.focus()},[o]);let w=()=>{let n=e.trim();n&&"connected"===o&&(p(n),t(""))};return"disconnected"===o||"connecting"===o?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,s.jsxs)("div",{className:"text-center p-8 bg-white rounded-lg shadow-lg max-w-md w-full mx-4",children:[(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"})}),(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"disconnected"===o?"Connecting...":"Joining Session..."}),(0,s.jsx)("p",{className:"text-gray-600",children:"Connecting to 2H+2AI conversation"})]})}):"error"===o?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,s.jsxs)("div",{className:"text-center p-8 bg-white rounded-lg shadow-lg max-w-md w-full mx-4",children:[(0,s.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDD0C"}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-red-600 mb-2",children:"Connection Error"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"Failed to connect to the WebSocket server. Check the browser console for more details."}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("button",{onClick:h,className:"bg-primary-600 text-white px-4 py-2 rounded hover:bg-primary-700 w-full",children:"Retry Connection"}),(0,s.jsx)("button",{onClick:()=>window.location.reload(),className:"bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400 w-full",children:"Reload Page"})]})]})}):g?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,s.jsxs)("div",{className:"text-center p-8 bg-white rounded-lg shadow-lg max-w-2xl w-full mx-4",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Session Complete! \uD83C\uDFAD"}),(0,s.jsx)("p",{className:"text-lg text-gray-700 mb-6",children:"Time's up! Here's who was who:"}),(0,s.jsx)("div",{className:"mb-6 p-4 bg-gray-100 rounded",children:(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Identity reveal coming soon..."})}),(0,s.jsx)("button",{onClick:()=>{b(),setTimeout(()=>h(),100)},className:"bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 font-medium",children:"Start New Session"})]})}):(0,s.jsxs)("div",{className:"flex flex-col h-screen bg-gray-50",children:[(0,s.jsx)("div",{className:"bg-white border-b border-gray-200 p-4",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-xl font-bold text-gray-900",children:["am I an AI? v.2 (","2025-07-01 17:34",")"]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Welcome, ",null==y?void 0:y.email," • You are participant ",(0,s.jsx)("span",{className:"font-mono font-bold text-primary-600",children:m})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(u,{}),(0,s.jsx)("button",{onClick:f,className:"text-sm text-gray-500 hover:text-gray-700",children:"Leave Session"}),(0,s.jsxs)("button",{onClick:v,className:"flex items-center gap-1 text-sm text-gray-500 hover:text-gray-700",children:[(0,s.jsx)(a.xqh,{size:16}),"Sign Out"]})]})]})}),(0,s.jsx)(d,{}),(0,s.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,s.jsx)(c,{})}),x&&(0,s.jsx)("div",{className:"bg-white border-t border-gray-200 p-4",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{ref:n,type:"text",value:e,onChange:e=>t(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),w())},placeholder:"Type your message...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 bg-white",maxLength:280}),(0,s.jsx)("button",{onClick:w,disabled:!e.trim(),className:"bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,s.jsx)(a.LbG,{size:20})})]}),(0,s.jsxs)("div",{className:"text-right text-xs text-gray-500 mt-1",children:[e.length,"/280"]})]})})]})}},3002:function(e,t,n){"use strict";n.d(t,{default:function(){return l}});var s=n(7437),r=n(2265),a=n(9376),i=n(4362);function l(e){let{children:t}=e,{isAuthenticated:n,isLoading:l}=(0,i.a)(),o=(0,a.useRouter)();return((0,r.useEffect)(()=>{l||n||o.push("/auth/signin")},[n,l,o]),l)?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})}):n?(0,s.jsx)(s.Fragment,{children:t}):null}},4362:function(e,t,n){"use strict";n.d(t,{AuthProvider:function(){return c},a:function(){return d}});var s=n(7437),r=n(2265),a=n(9376),i=n(7492),l=n(571);let o=(0,r.createContext)(void 0),c=e=>{let{children:t}=e,[n,c]=(0,r.useState)(!1),[d,u]=(0,r.useState)(!0),[m,x]=(0,r.useState)(null),g=(0,a.useRouter)(),h=async()=>{try{let e=await i.Y.getCurrentUser();e?(c(!0),x(e)):(c(!1),x(null))}catch(e){c(!1),x(null)}finally{u(!1)}};return(0,r.useEffect)(()=>{h()},[]),(0,s.jsx)(o.Provider,{value:{isAuthenticated:n,isLoading:d,user:m,checkAuth:h,signOut:()=>{i.Y.signOut(),c(!1),x(null),l.F.getState().reset(),window.localStorage.clear(),window.sessionStorage.clear(),g.push("/auth/signin")}},children:t})},d=()=>{let e=(0,r.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},7492:function(e,t,n){"use strict";n.d(t,{Y:function(){return a}});var s=n(3250);let r=new s.AM({UserPoolId:"us-east-1_ipC2hJAsT",ClientId:"6mvdodv3vud2pi5sv0oig920ne"}),a={signUp:async e=>{let{email:t,password:n}=e;return new Promise((e,a)=>{let i=[new s.KC({Name:"email",Value:t})];r.signUp(t,n,i,[],t=>{if(t){a({code:t.code||"UnknownError",message:t.message||"An unknown error occurred"});return}e()})})},confirmSignUp:async(e,t)=>new Promise((n,a)=>{new s.ws({Username:e,Pool:r}).confirmRegistration(t,!0,e=>{if(e){a({code:e.code||"UnknownError",message:e.message||"An unknown error occurred"});return}n()})}),signIn:async e=>{let{email:t,password:n}=e;return new Promise((e,a)=>{let i=new s.sD({Username:t,Password:n});new s.ws({Username:t,Pool:r}).authenticateUser(i,{onSuccess:()=>{e()},onFailure:e=>{a({code:e.code||"UnknownError",message:e.message||"An unknown error occurred"})}})})},getCurrentUser:async()=>new Promise(e=>{let t=r.getCurrentUser();if(!t){e(null);return}t.getSession((n,s)=>{if(n||!s||!s.isValid()){e(null);return}t.getUserAttributes((t,n)=>{var s,r;if(t||!n){e(null);return}let a=null===(s=n.find(e=>"email"===e.getName()))||void 0===s?void 0:s.getValue(),i=null===(r=n.find(e=>"sub"===e.getName()))||void 0===r?void 0:r.getValue();if(!a||!i){e(null);return}e({email:a,sub:i,role:"user"})})})}),signOut:()=>{let e=r.getCurrentUser();e&&e.signOut()},getIdToken:async()=>new Promise(e=>{let t=r.getCurrentUser();if(!t){e(null);return}t.getSession((t,n)=>{if(t||!n||!n.isValid()){e(null);return}e(n.getIdToken().getJwtToken())})})}},571:function(e,t,n){"use strict";n.d(t,{F:function(){return i}});var s=n(3011),r=n(6885);let a="wss://i5csamj3a8.execute-api.us-east-1.amazonaws.com/prod",i=(0,s.U)()((0,r.mW)((e,t)=>({connectionStatus:"disconnected",ws:null,sessionId:null,myIdentity:null,participants:[],messages:[],sessionStartTime:null,timeRemaining:null,isSessionActive:!1,isRevealed:!1,identityReveal:null,connect:()=>{var n;if((null===(n=t().ws)||void 0===n?void 0:n.readyState)!==WebSocket.OPEN){e({connectionStatus:"connecting"}),console.log("Attempting WebSocket connection to:",a);try{let n=new WebSocket(a);n.onopen=()=>{console.log("✅ WebSocket connected successfully"),e({connectionStatus:"connected",ws:n}),console.log("Sending join message..."),n.send(JSON.stringify({action:"join"}))},n.onmessage=e=>{try{let n=JSON.parse(e.data);switch(console.log("\uD83D\uDCE8 Received:",n),n.action){case"connected":t().handleConnect(n);break;case"message":t().handleMessage(n);break;case"participants":t().handleParticipantUpdate(n.participants);break;case"session_end":t().handleSessionEnd(n.reveal);break;default:console.log("Unknown message:",n)}}catch(e){console.error("Failed to parse message:",e)}},n.onerror=t=>{console.error("❌ WebSocket error:",t),console.error("WebSocket readyState:",n.readyState),e({connectionStatus:"error"})},n.onclose=n=>{console.log("\uD83D\uDD0C WebSocket disconnected. Code:",n.code,"Reason:",n.reason),e({connectionStatus:"disconnected",ws:null}),1e3!==n.code&&(console.log("\uD83D\uDD04 Retrying connection in 3 seconds..."),setTimeout(()=>{let e=t();"disconnected"===e.connectionStatus&&e.connect()},3e3))},setTimeout(()=>{n.readyState===WebSocket.CONNECTING&&(console.error("⏰ WebSocket connection timeout"),n.close(),e({connectionStatus:"error"}))},1e4)}catch(t){console.error("\uD83D\uDCA5 Failed to create WebSocket:",t),e({connectionStatus:"error"})}}},disconnect:()=>{let{ws:n}=t();n&&n.close(),e({connectionStatus:"disconnected",ws:null})},sendMessage:e=>{let{ws:n}=t();(null==n?void 0:n.readyState)===WebSocket.OPEN&&n.send(JSON.stringify({action:"message",content:e.trim()}))},handleConnect:t=>{e({myIdentity:t.identity,sessionId:t.sessionId,sessionStartTime:Date.now(),isSessionActive:!0,timeRemaining:600})},handleMessage:t=>{e(e=>({messages:[...e.messages,t]}))},handleParticipantUpdate:t=>{e({participants:t})},handleSessionEnd:t=>{e({isSessionActive:!1,isRevealed:!0,identityReveal:t,timeRemaining:0})},updateTimer:t=>{e({timeRemaining:t}),t<=0&&e({isSessionActive:!1})},reset:()=>{let{ws:n}=t();n&&n.close(),e({connectionStatus:"disconnected",ws:null,sessionId:null,myIdentity:null,participants:[],messages:[],sessionStartTime:null,timeRemaining:null,isSessionActive:!1,isRevealed:!1,identityReveal:null})}}),{name:"session-store"}))}},function(e){e.O(0,[956,181,755,971,117,744],function(){return e(e.s=255)}),_N_E=e.O()}]);