(()=>{var e={};e.id=931,e.ids=[931],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8893:e=>{"use strict";e.exports=require("buffer")},4770:e=>{"use strict";e.exports=require("crypto")},2615:e=>{"use strict";e.exports=require("http")},8791:e=>{"use strict";e.exports=require("https")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},7360:e=>{"use strict";e.exports=require("url")},1568:e=>{"use strict";e.exports=require("zlib")},8629:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>a.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>d,routeModule:()=>x,tree:()=>c}),s(7796),s(3817),s(5866);var n=s(3191),r=s(8716),i=s(7922),a=s.n(i),o=s(5231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);s.d(t,l);let c=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,7796)),"/Users/nico/src/amianai/v2/frontend/src/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,3817)),"/Users/nico/src/amianai/v2/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/nico/src/amianai/v2/frontend/src/app/page.tsx"],m="/page",u={require:s,loadChunk:()=>Promise.resolve()},x=new n.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},6407:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},5614:(e,t,s)=>{Promise.resolve().then(s.bind(s,4001))},8360:(e,t,s)=>{Promise.resolve().then(s.bind(s,6608)),Promise.resolve().then(s.bind(s,9573))},9573:(e,t,s)=>{"use strict";s.d(t,{default:()=>u});var n=s(326),r=s(7577),i=s(2534),a=s(9),o=s(4001);function l({message:e,isMyMessage:t}){return n.jsx("div",{className:`flex mb-4 ${t?"justify-end":"justify-start"}`,children:(0,n.jsxs)("div",{className:`max-w-xs lg:max-w-md ${t?"order-1":"order-2"}`,children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${{A:"bg-blue-100 text-blue-800",B:"bg-green-100 text-green-800",C:"bg-purple-100 text-purple-800",D:"bg-orange-100 text-orange-800"}[e.sender]}`,children:e.sender}),n.jsx("span",{className:"text-xs text-gray-500",children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),n.jsx("div",{className:`
          px-4 py-2 rounded-lg
          ${t?"bg-primary-600 text-white":"bg-white border border-gray-200"}
        `,children:n.jsx("p",{className:"text-sm whitespace-pre-wrap",children:e.content})})]})})}function c(){let{messages:e,myIdentity:t}=(0,a.F)(),s=(0,r.useRef)(null);return 0===e.length?n.jsx("div",{className:"flex items-center justify-center h-full",children:(0,n.jsxs)("div",{className:"text-center p-8",children:[n.jsx("div",{className:"text-4xl mb-4",children:"\uD83D\uDCAC"}),n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Waiting for conversation to begin"}),n.jsx("p",{className:"text-gray-600 max-w-md",children:"Once all participants join, the 10-minute anonymous conversation will start. Two humans and two AI participants will engage in discussion."})]})}):n.jsx("div",{className:"h-full overflow-y-auto",children:(0,n.jsxs)("div",{className:"max-w-4xl mx-auto p-4",children:[e.map((e,s)=>n.jsx(l,{message:e,isMyMessage:e.sender===t},`${e.timestamp}-${s}`)),n.jsx("div",{ref:s})]})})}function d(){let{participants:e,myIdentity:t}=(0,a.F)(),s=e=>({A:"bg-blue-500",B:"bg-green-500",C:"bg-purple-500",D:"bg-orange-500"})[e],r=["A","B","C","D"].map(s=>{let n=e.find(e=>e.identity===s);return{identity:s,isConnected:n?.isConnected??!1,isMe:s===t}});return n.jsx("div",{className:"bg-white border-b border-gray-200 px-4 py-3",children:(0,n.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[n.jsx("h2",{className:"text-sm font-medium text-gray-700",children:"Participants"}),(0,n.jsxs)("div",{className:"text-xs text-gray-500",children:[e.filter(e=>e.isConnected).length,"/4 connected"]})]}),n.jsx("div",{className:"flex gap-3 mt-2",children:r.map(({identity:e,isConnected:t,isMe:r})=>(0,n.jsxs)("div",{className:`
                flex items-center gap-2 px-3 py-2 rounded-lg border
                ${t?"border-gray-200 bg-gray-50":"border-dashed border-gray-300 bg-gray-25"}
                ${r?"ring-2 ring-primary-200":""}
              `,children:[n.jsx("div",{className:`
                w-3 h-3 rounded-full
                ${t?s(e):"bg-gray-300"}
              `}),n.jsx("span",{className:`
                text-sm font-medium
                ${t?"text-gray-900":"text-gray-400"}
              `,children:e}),r&&n.jsx("span",{className:"text-xs text-primary-600 font-medium",children:"(You)"}),!t&&n.jsx("span",{className:"text-xs text-gray-400",children:"Waiting..."})]},e))}),e.filter(e=>e.isConnected).length<4&&n.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Session will begin when all participants have joined"})]})})}function m(){let{timeRemaining:e,isSessionActive:t,updateTimer:s}=(0,a.F)();return t&&null!==e?(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsxs)("div",{className:"text-right",children:[n.jsx("div",{className:"text-xs text-gray-500",children:"Time remaining"}),n.jsx("div",{className:`text-sm font-mono font-bold ${e>300?"text-green-600":e>120?"text-yellow-600":"text-red-600"}`,children:`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`})]}),n.jsx("div",{className:"w-20 h-2 bg-gray-200 rounded-full overflow-hidden",children:n.jsx("div",{className:`h-full transition-all duration-1000 ${e>300?"bg-green-500":e>120?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.max(0,e/600*100)}%`}})})]}):null}function u(){let[e,t]=(0,r.useState)(""),s=(0,r.useRef)(null),{connectionStatus:l,myIdentity:u,isSessionActive:x,isRevealed:g,connect:h,disconnect:p,sendMessage:b,reset:y}=(0,a.F)(),{user:v,signOut:f}=(0,o.a)(),j=()=>{let s=e.trim();s&&"connected"===l&&(b(s),t(""))};return"disconnected"===l||"connecting"===l?n.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,n.jsxs)("div",{className:"text-center p-8 bg-white rounded-lg shadow-lg max-w-md w-full mx-4",children:[n.jsx("div",{className:"mb-4",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"})}),n.jsx("h2",{className:"text-xl font-semibold mb-2",children:"disconnected"===l?"Connecting...":"Joining Session..."}),n.jsx("p",{className:"text-gray-600",children:"Connecting to 2H+2AI conversation"})]})}):"error"===l?n.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,n.jsxs)("div",{className:"text-center p-8 bg-white rounded-lg shadow-lg max-w-md w-full mx-4",children:[n.jsx("div",{className:"text-4xl mb-4",children:"\uD83D\uDD0C"}),n.jsx("h2",{className:"text-xl font-semibold text-red-600 mb-2",children:"Connection Error"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"Failed to connect to the WebSocket server. Check the browser console for more details."}),(0,n.jsxs)("div",{className:"space-y-2",children:[n.jsx("button",{onClick:h,className:"bg-primary-600 text-white px-4 py-2 rounded hover:bg-primary-700 w-full",children:"Retry Connection"}),n.jsx("button",{onClick:()=>window.location.reload(),className:"bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400 w-full",children:"Reload Page"})]})]})}):g?n.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,n.jsxs)("div",{className:"text-center p-8 bg-white rounded-lg shadow-lg max-w-2xl w-full mx-4",children:[n.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Session Complete! \uD83C\uDFAD"}),n.jsx("p",{className:"text-lg text-gray-700 mb-6",children:"Time's up! Here's who was who:"}),n.jsx("div",{className:"mb-6 p-4 bg-gray-100 rounded",children:n.jsx("p",{className:"text-sm text-gray-600",children:"Identity reveal coming soon..."})}),n.jsx("button",{onClick:()=>{y(),setTimeout(()=>h(),100)},className:"bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 font-medium",children:"Start New Session"})]})}):(0,n.jsxs)("div",{className:"flex flex-col h-screen bg-gray-50",children:[n.jsx("div",{className:"bg-white border-b border-gray-200 p-4",children:(0,n.jsxs)("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("h1",{className:"text-xl font-bold text-gray-900",children:["am I an AI? v.2 (","2025-07-01 17:34",")"]}),(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:["Welcome, ",v?.email," • You are participant ",n.jsx("span",{className:"font-mono font-bold text-primary-600",children:u})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[n.jsx(m,{}),n.jsx("button",{onClick:p,className:"text-sm text-gray-500 hover:text-gray-700",children:"Leave Session"}),(0,n.jsxs)("button",{onClick:f,className:"flex items-center gap-1 text-sm text-gray-500 hover:text-gray-700",children:[n.jsx(i.xqh,{size:16}),"Sign Out"]})]})]})}),n.jsx(d,{}),n.jsx("div",{className:"flex-1 overflow-hidden",children:n.jsx(c,{})}),x&&n.jsx("div",{className:"bg-white border-t border-gray-200 p-4",children:(0,n.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,n.jsxs)("div",{className:"flex gap-2",children:[n.jsx("input",{ref:s,type:"text",value:e,onChange:e=>t(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),j())},placeholder:"Type your message...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 bg-white",maxLength:280}),n.jsx("button",{onClick:j,disabled:!e.trim(),className:"bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:n.jsx(i.LbG,{size:20})})]}),(0,n.jsxs)("div",{className:"text-right text-xs text-gray-500 mt-1",children:[e.length,"/280"]})]})})]})}},6608:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});var n=s(326);s(7577);var r=s(5047),i=s(4001);function a({children:e}){let{isAuthenticated:t,isLoading:s}=(0,i.a)();return((0,r.useRouter)(),s)?n.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,n.jsxs)("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):t?n.jsx(n.Fragment,{children:e}):null}},4001:(e,t,s)=>{"use strict";s.d(t,{AuthProvider:()=>c,a:()=>d});var n=s(326),r=s(7577),i=s(5047),a=s(9580),o=s(9);let l=(0,r.createContext)(void 0),c=({children:e})=>{let[t,s]=(0,r.useState)(!1),[c,d]=(0,r.useState)(!0),[m,u]=(0,r.useState)(null),x=(0,i.useRouter)(),g=async()=>{try{let e=await a.Y.getCurrentUser();e?(s(!0),u(e)):(s(!1),u(null))}catch(e){s(!1),u(null)}finally{d(!1)}};return(0,r.useEffect)(()=>{g()},[]),n.jsx(l.Provider,{value:{isAuthenticated:t,isLoading:c,user:m,checkAuth:g,signOut:()=>{a.Y.signOut(),s(!1),u(null),o.F.getState().reset(),x.push("/auth/signin")}},children:e})},d=()=>{let e=(0,r.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9580:(e,t,s)=>{"use strict";s.d(t,{Y:()=>i});var n=s(3541);let r=new n.AM({UserPoolId:"us-east-1_ipC2hJAsT",ClientId:"6mvdodv3vud2pi5sv0oig920ne"}),i={signUp:async({email:e,password:t})=>new Promise((s,i)=>{let a=[new n.KC({Name:"email",Value:e})];r.signUp(e,t,a,[],e=>{if(e){i({code:e.code||"UnknownError",message:e.message||"An unknown error occurred"});return}s()})}),confirmSignUp:async(e,t)=>new Promise((s,i)=>{new n.ws({Username:e,Pool:r}).confirmRegistration(t,!0,e=>{if(e){i({code:e.code||"UnknownError",message:e.message||"An unknown error occurred"});return}s()})}),signIn:async({email:e,password:t})=>new Promise((s,i)=>{let a=new n.sD({Username:e,Password:t});new n.ws({Username:e,Pool:r}).authenticateUser(a,{onSuccess:()=>{s()},onFailure:e=>{i({code:e.code||"UnknownError",message:e.message||"An unknown error occurred"})}})}),getCurrentUser:async()=>new Promise(e=>{let t=r.getCurrentUser();if(!t){e(null);return}t.getSession((s,n)=>{if(s||!n||!n.isValid()){e(null);return}t.getUserAttributes((t,s)=>{if(t||!s){e(null);return}let n=s.find(e=>"email"===e.getName())?.getValue(),r=s.find(e=>"sub"===e.getName())?.getValue();if(!n||!r){e(null);return}e({email:n,sub:r,role:"user"})})})}),signOut:()=>{let e=r.getCurrentUser();e&&e.signOut()},getIdToken:async()=>new Promise(e=>{let t=r.getCurrentUser();if(!t){e(null);return}t.getSession((t,s)=>{if(t||!s||!s.isValid()){e(null);return}e(s.getIdToken().getJwtToken())})})}},9:(e,t,s)=>{"use strict";s.d(t,{F:()=>a});var n=s(8408),r=s(5251);let i="wss://i5csamj3a8.execute-api.us-east-1.amazonaws.com/prod",a=(0,n.U)()((0,r.mW)((e,t)=>({connectionStatus:"disconnected",ws:null,sessionId:null,myIdentity:null,participants:[],messages:[],sessionStartTime:null,timeRemaining:null,isSessionActive:!1,isRevealed:!1,identityReveal:null,connect:()=>{let s=t();if(s.ws?.readyState!==WebSocket.OPEN){e({connectionStatus:"connecting"}),console.log("Attempting WebSocket connection to:",i);try{let s=new WebSocket(i);s.onopen=()=>{console.log("✅ WebSocket connected successfully"),e({connectionStatus:"connected",ws:s}),console.log("Sending join message..."),s.send(JSON.stringify({action:"join"}))},s.onmessage=e=>{try{let s=JSON.parse(e.data);switch(console.log("\uD83D\uDCE8 Received:",s),s.action){case"connected":t().handleConnect(s);break;case"message":t().handleMessage(s);break;case"participants":t().handleParticipantUpdate(s.participants);break;case"session_end":t().handleSessionEnd(s.reveal);break;default:console.log("Unknown message:",s)}}catch(e){console.error("Failed to parse message:",e)}},s.onerror=t=>{console.error("❌ WebSocket error:",t),console.error("WebSocket readyState:",s.readyState),e({connectionStatus:"error"})},s.onclose=s=>{console.log("\uD83D\uDD0C WebSocket disconnected. Code:",s.code,"Reason:",s.reason),e({connectionStatus:"disconnected",ws:null}),1e3!==s.code&&(console.log("\uD83D\uDD04 Retrying connection in 3 seconds..."),setTimeout(()=>{let e=t();"disconnected"===e.connectionStatus&&e.connect()},3e3))},setTimeout(()=>{s.readyState===WebSocket.CONNECTING&&(console.error("⏰ WebSocket connection timeout"),s.close(),e({connectionStatus:"error"}))},1e4)}catch(t){console.error("\uD83D\uDCA5 Failed to create WebSocket:",t),e({connectionStatus:"error"})}}},disconnect:()=>{let{ws:s}=t();s&&s.close(),e({connectionStatus:"disconnected",ws:null})},sendMessage:e=>{let{ws:s}=t();s?.readyState===WebSocket.OPEN&&s.send(JSON.stringify({action:"message",content:e.trim()}))},handleConnect:t=>{e({myIdentity:t.identity,sessionId:t.sessionId,sessionStartTime:Date.now(),isSessionActive:!0,timeRemaining:600})},handleMessage:t=>{e(e=>({messages:[...e.messages,t]}))},handleParticipantUpdate:t=>{e({participants:t})},handleSessionEnd:t=>{e({isSessionActive:!1,isRevealed:!0,identityReveal:t,timeRemaining:0})},updateTimer:t=>{e({timeRemaining:t}),t<=0&&e({isSessionActive:!1})},reset:()=>{let{ws:s}=t();s&&s.close(),e({connectionStatus:"disconnected",ws:null,sessionId:null,myIdentity:null,participants:[],messages:[],sessionStartTime:null,timeRemaining:null,isSessionActive:!1,isRevealed:!1,identityReveal:null})}}),{name:"session-store"}))},3817:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o,metadata:()=>a});var n=s(9510);s(5023);var r=s(8570);let i=(0,r.createProxy)(String.raw`/Users/nico/src/amianai/v2/frontend/src/contexts/AuthContext.tsx#AuthProvider`);(0,r.createProxy)(String.raw`/Users/nico/src/amianai/v2/frontend/src/contexts/AuthContext.tsx#useAuth`);let a={title:"AmIAnAI v2 - 2H+2AI Conversations",description:"Anonymous real-time conversations between 2 humans and 2 AIs"};function o({children:e}){return n.jsx("html",{lang:"en",children:n.jsx("body",{className:"antialiased",children:n.jsx(i,{children:e})})})}},7796:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s(9510),r=s(8570);let i=(0,r.createProxy)(String.raw`/Users/nico/src/amianai/v2/frontend/src/components/ChatInterface.tsx#default`),a=(0,r.createProxy)(String.raw`/Users/nico/src/amianai/v2/frontend/src/components/auth/ProtectedRoute.tsx#default`);function o(){return n.jsx(a,{children:n.jsx(i,{})})}},5023:()=>{}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),n=t.X(0,[288,534],()=>s(8629));module.exports=n})();